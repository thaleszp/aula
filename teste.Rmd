---
title: "Seleção de modelos lineares"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Subset selection

Qual modelo linear devo utilizar? 

Não podemos simplesmente utilizar a soma dos quadrados dos resíduos (SQR) porque, para cada variável adiconada, a SQR diminui de forma monotônica. Da mesma forma, com K+1, o R^2 aumenta de forma monotônica.

Utilizaremos critérios de informação para escolher o modelo. 

Exemplo com os seguintes pacotes:

```{r, message=FALSE}
library(wooldridge)
data("wage1")
library(leaps) #pacote com funções para seleção de modelo.
library(tidyverse)
```

?wage1 para ver o conjunto de variáveis

## Definir qual conjunto de variáveis será testado.

```{r teste}
wage1a <- wage1 %>% select (wage, educ, exper, expersq, female, nonwhite, married)
regfit<-regsubsets(wage~., data=wage1a)
summary(regfit)
reg.summ <- summary(regfit)
names(reg.summ)

```

* Para utilizar todas as variaveis disponíveis: regfit2<-regsubsets(wage~., data=wage1, nvmax = 24) 

Utilizaremos o critério de informação CP (Em modelos lineares (com erros normais), CP e AIC são equivalentes.)


## Gráficos


```{r}
plot(reg.summ$cp,xlab="Numero de variaveis", ylab="CP") # Mostra a quantidade de variáveis que minimiza o erro.
```

```{r}
which.min(reg.summ$cp) #comando para mostrar o menor valor de CP no gráfico.

coef(regfit,4) #mostrar os coeficiente para o modelo com menor CP.
```














